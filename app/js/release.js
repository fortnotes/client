/*! fortnotes-client v2.0.0 (webpack: v1.13.2) */
!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";var n=i(1),s=i(7);n.nodes=JSON.parse(localStorage.getItem("nodes"))||[],n.nodeId=localStorage.getItem("nodeId"),n.nodeId||!function(){var e=new Uint8Array(32),t=[];window.crypto.getRandomValues(e),e.forEach(function(e){e=e.toString(16),1===e.length&&(e="0"+e),t.push(e)}),localStorage.setItem("nodeId",n.nodeId=t.join(""))}(),window.nodeId.innerText="nodeId: "+n.nodeId,n.wamp=new s("ws://"+(n.query.wampHost||location.hostname)+":8090/"+n.nodeId),n.wamp.onopen=function(){window.nodeId.classList.add("online"),n.wamp.call("ping",{},function(e,t){})},n.wamp.onclose=function(){window.nodeId.classList.remove("online")},n.pages={main:i(9)},n.route(n.pages.main),n.once("load",function(){})},function(e,t,i){"use strict";var n=i(2),s=i(6);Object.keys(s).forEach(function(e){window.addEventListener(e,s[e])}),e.exports=n},function(e,t,i){"use strict";function n(e,t){return!(!e||e.active)&&(e.$node.classList.add("active"),e.active=!0,r.activePage=e,e.events.show&&e.emit("show",{page:e,data:t}),!0)}function s(e){return!(!e||!e.active)&&(e.$node.classList.remove("active"),e.active=!1,r.activePage=null,e.events.hide&&e.emit("hide",{page:e}),!0)}var o=i(3),a=i(4).parse,r=new o;r.query=a(document.location.search.substring(1)),r.config=i(5),r.activePage=null,r.route=function(e,t){var i=r.activePage;return!(!e||e.active)&&(s(r.activePage),n(e,t),this.events.route&&this.emit("route",{from:i,to:e}),!0)},e.exports=r},function(e,t,i){"use strict";function n(){this.events={}}n.prototype={addListener:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},once:function(e,t){var i=this;this.events[e]=this.events[e]||[],this.events[e].push(function n(){t.apply(i,arguments),i.removeListener(e,n)})},addListeners:function(e){var t;for(t in e)e.hasOwnProperty(t)&&this.addListener(t,e[t])},removeListener:function(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(function(e){return e!==t}),0===this.events[e].length&&(this.events[e]=void 0))},emit:function(e){var t,i=this.events[e];if(i)for(t=0;t<i.length;t++)i[t].apply(this,Array.prototype.slice.call(arguments,1))}},n.prototype.constructor=n,e.exports=n},function(e,t){"use strict";e.exports={parse:function(e){var t={};return e.split("&").forEach(function(e){e=e.split("="),2===e.length&&(t[e[0]]=decodeURIComponent(e[1]))}),t},stringify:function(e){var t=[];return Object.keys(e).forEach(function(i){t.push(i+"="+encodeURIComponent(e[i]))}),t.join("&")}}},function(e,t){"use strict";e.exports={}},function(e,t,i){"use strict";var n=i(2);e.exports={DOMContentLoaded:function(e){n.events.dom&&n.emit("dom",e)},load:function(e){n.events[e.type]&&n.emit(e.type,e)},unload:function(e){n.events[e.type]&&n.emit(e.type,e)},error:function(e){},keydown:function(e){var t,i=n.activePage,s={code:e.keyCode,stop:!1};e.ctrlKey&&(s.code+="c"),e.altKey&&(s.code+="a"),e.shiftKey&&(s.code+="s"),t=i.activeComponent,t&&t!==i&&(t.events[e.type]&&t.emit(e.type,s,e),!s.stop&&t.propagate&&t.parent&&t.parent.events[e.type]&&t.parent.emit(e.type,s,e)),s.stop||(i.events[e.type]&&i.emit(e.type,s,e),e.stop||n.events[e.type]&&n.emit(e.type,s,e))},keypress:function(e){var t=n.activePage;t.activeComponent&&t.activeComponent!==t&&t.activeComponent.events[e.type]&&t.activeComponent.emit(e.type,e)},mousewheel:function(e){var t=n.activePage;t.activeComponent&&t.activeComponent!==t&&t.activeComponent.events[e.type]&&t.activeComponent.emit(e.type,e),e.stop||t.events[e.type]&&t.emit(e.type,e)}}},function(e,t,i){"use strict";function n(e,t){function i(){var t=new WebSocket(e);return t.onopen=function(){"function"==typeof n.onopen&&n.onopen(),n.open=!0},t.onclose=function(){"function"==typeof n.onclose&&n.onclose(),n.open=!1,n.timeout&&setTimeout(function(){n.socket=i(),n.socket.onmessage=function(e){n.router(e.data)}},n.timeout)},t}var n=this;t=t||{},this.open=!1,t.timeout&&(this.timeout=t.timeout),this.onopen=null,this.onclose=null,s.call(this,i())}var s=i(8);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.timeout=5e3,e.exports=n},function(e,t,i){"use strict";function n(e){var t=this;o.call(this),this.socket=e,"on"in e?e.on("message",function(e){t.router(e)}):"onmessage"in e&&(e.onmessage=function(e){t.router(e.data)})}function s(e,t){1===e.readyState&&(t.jsonrpc="2.0",e.send(JSON.stringify(t)))}var o=i(3),a=0,r={};n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.router=function(e){var t,i=this;try{t=JSON.parse(e)}catch(n){return void s(this.socket,{error:{code:-32700,message:"Parse error"},id:null})}"id"in t&&!("method"in t)?t.id in r&&(r[t.id](t.error,t.result),delete r[t.id]):!("id"in t)&&"method"in t?this.events[t.method]&&this.emit(t.method,t.params):"id"in t&&"method"in t?this.events[t.method]?this.emit(t.method,t.params,function(e,n){s(i.socket,{error:e,result:n,id:t.id})}):s(this.socket,{error:{code:-32601,message:"Method not found"},id:t.id}):s(this.socket,{error:{code:-32600,message:"Invalid Request"},id:null})},n.prototype.call=function(e,t,i){var n={method:e,params:t};"function"==typeof i&&(n.id=++a,r[a]=i),s(this.socket,n)},e.exports=n},function(e,t,i){"use strict";function n(e){e&&a.nodes.indexOf(e)===-1&&(a.nodes.push(e),localStorage.setItem("nodes",JSON.stringify(a.nodes)))}function s(e){o=h.Offerer.createOffer(function(t){a.wamp.call("connect",{id:e,sdp:t},function(t,i){t||(o.setRemoteDescription(i),n(e))})}),o.peer.onicecandidate=function(t){t.candidate&&a.wamp.call("ice",{id:e,candidate:t.candidate})}}var o,a=i(1),r=i(10),c=i(13),d=i(14),h=i(15),p=(i(16),new d({$node:window.pageMain}));a.wamp.addListener("connect",function(e,t){(a.nodes.indexOf(e.id)!==-1||confirm("Do you want to add new node with id "+e.id))&&(o=h.Answerer.createAnswer(e.sdp,function(i){t(null,i),n(e.id),o.peer.onicecandidate=function(t){t.candidate&&a.wamp.call("ice",{id:e.id,candidate:t.candidate})}}))}),a.wamp.addListener("ice",function(e){o.addIceCandidate(e.candidate)}),p.add(p.nodeList=new c({$node:window.pmNodeList,data:a.nodes.slice()})),p.add(new r({$node:window.pmBtnDisconnect,value:"Disconnect",events:{click:function(){a.wamp.socket.onclose(),a.wamp.socket.onclose=null,a.wamp.socket.close()}}})),p.add(new r({$node:window.pmBtnAddNode,value:"Add node",events:{click:function(){var e=prompt("Please enter the node id to link with.");e&&s(e)}}})),setTimeout(function(){a.nodes.forEach(function(e){s(e)})},500),e.exports=p},function(e,t,i){"use strict";function n(e){e=e||{},s.call(this,e),e.icon&&(this.$icon=this.$body.appendChild(document.createElement("div")),this.$icon.className="icon "+e.icon),this.$text=this.$body.appendChild(document.createElement("div")),this.$text.classList.add("text"),e.value&&(this.$text.innerText=e.value)}var s=i(11),o=i(12);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.name="spa-component-button",n.prototype.clickDuration=200,n.prototype.defaultEvents={click:function(){var e=this;this.$node.classList.add("click"),setTimeout(function(){e.$node.classList.remove("click")},this.clickDuration)},keydown:function(e){e.code===o.enter&&this.events.click&&this.emit("click",{event:e})}},e.exports=n},function(e,t,i){"use strict";function n(e){var t,i=this;if(e=e||{},this.visible=!0,this.focusable=!0,this.$node=null,this.$body=null,this.parent=null,this.children=[],this.propagate=!!e.propagate,o.call(this,e.data),this.$node=e.$node||document.createElement("div"),this.$body=e.$body||this.$node,this.$node.className=this.name+" "+(e.className||""),this.id=e.id||this.$node.id||"cid"+a++,e.parent&&e.parent.add(this),e.visible===!1&&this.hide(),e.focusable===!1&&(this.focusable=!1),this.defaultEvents){e.events=e.events||{};for(t in this.defaultEvents)e.events[t]=e.events[t]||this.defaultEvents[t]}e.events&&Object.keys(e.events).forEach(function(t){i.addListener(t,e.events[t])}),e.children&&this.add.apply(this,e.children),this.$node.addEventListener("click",function(e){i.focus(),i.events.click&&i.emit("click",e),e.stopPropagation()})}var s=i(2),o=i(3),a=0;n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.defaultEvents=null,n.prototype.add=function(e){var t;for(t=0;t<arguments.length;t++)e=arguments[t],this.children.push(e),e.parent=this,e.$node&&null===e.$node.parentNode&&this.$body.appendChild(e.$node),this.events.add&&this.emit("add",{item:e})},n.prototype.remove=function(){this.parent&&(s.activePage.activeComponent===this&&(this.blur(),this.parent.focus()),this.parent.children.splice(this.parent.children.indexOf(this),1)),this.children.forEach(function(e){e.remove()}),this.events={},this.$node.parentNode.removeChild(this.$node),this.events.remove&&this.emit("remove")},n.prototype.focus=function(e){var t=s.activePage,i=t.activeComponent;return!(!this.focusable||this===i)&&(i&&i.blur(),t.activeComponent=i=this,i.$node.classList.add("focus"),i.events.focus&&i.emit("focus",e),!0)},n.prototype.blur=function(){var e=s.activePage,t=e.activeComponent;return this.$node.classList.remove("focus"),this===t&&(e.activeComponent=null,this.events.blur&&this.emit("blur"),!0)},n.prototype.show=function(e){return!!this.visible||(this.$node.classList.remove("hidden"),this.visible=!0,this.events.show&&this.emit("show",e),!0)},n.prototype.hide=function(){return!this.visible||(this.$node.classList.add("hidden"),this.visible=!1,this.events.hide&&this.emit("hide"),!0)},e.exports=n},function(e,t){"use strict";e.exports={backspace:8,tab:9,enter:13,escape:27,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46}},function(e,t,i){"use strict";function n(e){e=e||{},this.$focusItem=null,this.viewIndex=null,this.data=[],this.type=this.TYPE_VERTICAL,this.size=5,this.cycle=!1,this.scroll=null,e.type&&(this.type=e.type),this.provider=null,this.type===this.TYPE_HORIZONTAL&&(e.className+=" horizontal"),o.call(this,e),this.init(e)}function s(e){var t,i;for(t=0;t<e.length;t++)i=e[t],"object"!=typeof i&&(i=e[t]={value:e[t]});return e}var o=i(11),a=i(12);n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.name="spa-component-list",n.prototype.TYPE_VERTICAL=1,n.prototype.TYPE_HORIZONTAL=2,n.prototype.renderItemDefault=function(e,t){e.innerText=t.value},n.prototype.renderItem=n.prototype.renderItemDefault,n.prototype.defaultEvents={mousewheel:function(e){this.type===this.TYPE_VERTICAL&&e.wheelDeltaY&&this.move(e.wheelDeltaY>0?a.up:a.down),this.type===this.TYPE_HORIZONTAL&&e.wheelDeltaX&&this.move(e.wheelDeltaX>0?a.left:a.right)},keydown:function(e){switch(e.code){case a.up:case a.down:case a.right:case a.left:case a.pageUp:case a.pageDown:case a.home:case a.end:this.move(e.code);break;case a.enter:this.events["click:item"]&&this.$focusItem&&this.emit("click:item",{$item:this.$focusItem,event:e})}}},n.prototype.init=function(e){var t,i,n=this,s=this.$body.children.length,o=function(e){this.data&&(n.focusItem(this),n.events["click:item"]&&n.emit("click:item",{$item:this,event:e}))};if(void 0!==e.cycle&&(this.cycle=e.cycle),e.scroll&&(this.scroll=e.scroll),e.provider&&(this.provider=e.provider),e.render&&(this.renderItem=e.render),e.size&&(this.size=e.size),this.size!==s)for(s>0&&(this.$body.innerText=null),i=0;i<this.size;i++)t=document.createElement("div"),t.index=i,t.className="item",t.addEventListener("click",o),this.$body.appendChild(t);this.provider?this.provider.get(null,function(t,i){t?n.events["data:error"]&&n.emit("data:error",t):(i&&(e.data=i,n.setData(e),n.scroll&&n.scroll.init({realSize:n.provider.maxCount,viewSize:n.provider.size,value:n.provider.head+n.provider.pos})),n.events["data:get"]&&n.emit("data:get"))}):e.data&&this.setData(e)},n.prototype.setData=function(e){e.data&&(this.data=s(e.data)),this.viewIndex=null,this.$focusItem&&this.blurItem(this.$focusItem),this.scroll&&(this.provider?this.scroll.realSize!==this.provider.maxCount&&this.scroll.init({realSize:this.provider.maxCount,viewSize:this.provider.size,value:this.provider.head+this.provider.pos}):this.scroll.init({realSize:this.data.length,viewSize:this.size,value:e.viewIndex||0})),void 0!==e.focusIndex&&this.data.length?this.focusIndex(e.focusIndex):this.renderView(e.viewIndex||0)},n.prototype.renderView=function(e){var t,i,n,s,o;if(this.viewIndex!==e){for(s=this.viewIndex,this.viewIndex=o=e,i=0;i<this.size;i++)t=this.$body.children[i],n=this.data[e],n?(t.data=n,t.index=e,this.renderItem(t,n),n.mark?t.classList.add("mark"):t.classList.remove("mark")):(t.data=t.index=void 0,t.innerHTML="&nbsp;",t.ready=!1),e++;return this.events["move:view"]&&this.emit("move:view",{prevIndex:s,currIndex:o}),this.events["select:item"]&&this.emit("select:item",{$item:t}),this.scroll&&this.scroll.scrollTo(this.provider?this.provider.head+this.provider.pos:this.viewIndex),!0}return!1},n.prototype.move=function(e){var t=this,i=!1;if(this.data.length)switch(e){case a.left:if(this.type!==this.TYPE_HORIZONTAL)break;i=!0;case a.up:(i||this.type===this.TYPE_VERTICAL)&&(this.$focusItem&&this.$focusItem.index>0?this.$focusItem===this.$body.firstChild?this.renderView(this.viewIndex-1):this.focusItem(this.$focusItem.previousSibling):this.provider?this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0===n?n:t.$focusItem.index})}):(this.cycle&&this.move(a.end),this.events.overflow&&this.emit("overflow",{direction:e,cycle:this.cycle})));break;case a.right:if(this.type!==this.TYPE_HORIZONTAL)break;i=!0;case a.down:(i||this.type===this.TYPE_VERTICAL)&&(this.$focusItem&&this.$focusItem.index<this.data.length-1?this.$focusItem===this.$body.lastChild?this.renderView(this.viewIndex+1):this.focusItem(this.$focusItem.nextSibling):this.provider?this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0===n?n:t.$focusItem.index})}):(this.cycle&&this.move(a.home),this.events.overflow&&this.emit("overflow",{direction:e,cycle:this.cycle})));break;case a.pageUp:if(this.provider)return void this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n?n:0})});this.viewIndex<this.size?this.renderView(0):this.renderView(this.viewIndex-this.size+1),this.focusItem(this.$body.firstChild);break;case a.pageDown:if(this.provider){this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0===n?n:i.length<t.size?i.length-1:t.size-1})});break}this.data.length>this.size?(this.viewIndex>this.data.length-2*this.size?this.renderView(this.data.length-this.size):this.renderView(this.viewIndex+this.size-1),this.focusItem(this.$body.lastChild)):this.focusItem(this.$body.children[this.data.length-1]);break;case a.home:if(this.provider){this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n?n:0})});break}this.renderView(0),this.focusItem(this.$body.firstChild);break;case a.end:if(this.provider){this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0===n?n:i.length<t.size?i.length-1:t.size-1})});break}this.data.length>this.size?(this.renderView(this.data.length-this.size),this.focusItem(this.$body.lastChild)):this.focusItem(this.$body.children[this.data.length-1])}},n.prototype.focusItem=function(e){var t=this.$focusItem;return!(!e||t===e)&&(null!==t&&(t.classList.remove("focus"),this.events["blur:item"]&&this.emit("blur:item",{$item:t})),this.$focusItem=e,this.$focusItem.data=this.data[this.$focusItem.index],e.classList.add("focus"),this.events["focus:item"]&&this.emit("focus:item",{$prev:t,$curr:e}),this.events["select:item"]&&this.emit("select:item",{$item:e}),!0)},n.prototype.blurItem=function(e){return!!e&&(e===this.$focusItem&&(this.$focusItem=null),e.classList.remove("focus"),this.events["blur:item"]&&this.emit("blur:item",{$item:e}),!0)},n.prototype.focusIndex=function(e){var t=this.viewIndex||0;e>=t+this.size?(e=e<this.data.length-1?e:this.data.length-1,this.renderView(e-this.size+1),this.focusItem(this.$body.lastChild)):e<t?(e=e>0?e:0,this.renderView(e),this.focusItem(this.$body.firstChild)):(null===this.viewIndex&&this.renderView(0),this.focusItem(this.$body.children[e-t]))},n.prototype.markItem=function(e,t){t?e.classList.add("mark"):e.classList.remove("mark"),e.data.mark=t},e.exports=n},function(e,t,i){"use strict";function n(e){e=e||{},this.active=!1,this.activeComponent=null,s.call(this,e),this.active=this.$node.classList.contains("active"),null===this.$node.parentNode&&document.body.appendChild(this.$node),this.page=this}var s=i(11);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.name="spa-component-page",e.exports=n},function(e,t){"use strict";function i(e){}function n(e){e.onmessage=function(e){var t=JSON.parse(e.data);window.messages.value+="<< "+t+"\n"},e.onopen=function(){e.push=e.send,e.send=function(t){e.push(JSON.stringify(t))}},e.onerror=function(e){},e.onclose=function(e){}}var s,o,a=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,r=window.RTCSessionDescription||window.mozRTCSessionDescription,c=window.RTCIceCandidate||window.mozRTCIceCandidate,d={iceServers:[{urls:"stun:stun.services.mozilla.com"},{urls:"stun:stun.l.google.com:19302"}]},h={optional:[{DtlsSrtpKeyAgreement:!0}]},p={createOffer:function(e){var t=new a(d,h);return s=t.createDataChannel("channel",{reliable:!0}),n(s),t.onsignalingstatechange=function(e){},t.oniceconnectionstatechange=function(e){},t.createOffer(function(i){t.setLocalDescription(i),e(i)},i),this.peer=t,this},setRemoteDescription:function(e){this.peer.setRemoteDescription(new r(e),function(){},i)},addIceCandidate:function(e){this.peer.addIceCandidate(new c({sdpMLineIndex:e.sdpMLineIndex,candidate:e.candidate}),function(){},i)}},l={createAnswer:function(e,t){var s=new a(d,h);return s.ondatachannel=function(e){o=e.channel,n(o)},s.onsignalingstatechange=function(e){},s.oniceconnectionstatechange=function(e){},s.setRemoteDescription(new r(e),function(){},i),s.createAnswer(function(e){s.setLocalDescription(e),t(e)},i),this.peer=s,this},addIceCandidate:function(e){this.peer.addIceCandidate(new c({sdpMLineIndex:e.sdpMLineIndex,candidate:e.candidate}),function(){},i)}};e.exports={Offerer:p,Answerer:l,setChannelEvents:n}},function(e,t,i){"use strict";function n(e){e=e||{},s.call(this,e),this.filterText="",this.init(e),this.addListener("click",function(e){})}var s=i(11);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.name="app-component-node-list",n.prototype.defaultEvents={},n.prototype.init=function(e){var t=this;this.data=e.data||{},Object.keys(this.data).forEach(function(e){var i=document.createElement("div"),n=t.data[e];i.innerText=i.taskId=e,i.className="item"+(n.running?" running":""),n.$node=i,t.$node.appendChild(i)})},n.prototype.matchFilter=function(e){return!(this.filterText&&e.innerText.indexOf(this.filterText)===-1)},n.prototype.applyFilter=function(){var e,t,i=this.$body.children;for(e=i.length;e--;)t=i[e],t.style.display=this.matchFilter(t)?"block":"none"},n.prototype.add=function(e){var t=this,i=document.createElement("div"),n=document.createElement("div");i.className="item",e.tags=e.tags||[],e.tags.push(e.type),e.tags.forEach(function(e){var i=document.createElement("div");i.className="tag",i.innerText=e,i.addEventListener("click",function(i){i.ctrlKey?(t.excludeTags.push(e),window.pageMainTagsExclude.value=window.pageMainTagsExclude.value+(window.pageMainTagsExclude.value?" ":"")+e):(t.includeTags.push(e),window.pageMainTagsInclude.value=window.pageMainTagsInclude.value+(window.pageMainTagsInclude.value?" ":"")+e),t.applyFilter()})}),i.classList.add(e.type),i.tags=e.tags,n.className="info",n.innerText=e.data,i.addEventListener("click",function(){app.wamp.call("getLinkData",{targetId:128,linkId:e.data.link},function(e,t){})}),i.appendChild(n),this.matchFilter(i)||(i.style.display="none"),this.$body.appendChild(i)},e.exports=n}]);
//# sourceMappingURL=release.map